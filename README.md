# èŒå¨˜ç™¾ç§‘ MCP æœåŠ¡å™¨

åŸºäº Node.js å’Œ TypeScript çš„èŒå¨˜ç™¾ç§‘ä¸“ç”¨ MCP æœåŠ¡å™¨ï¼Œæä¾›æœç´¢ã€é¡µé¢è·å–ç­‰åŠŸèƒ½ï¼ŒåŒ…å«å®Œæ•´çš„ CLI è°ƒè¯•å·¥å…·ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” **æœç´¢èŒå¨˜ç™¾ç§‘æ¡ç›®** - æ”¯æŒå…³é”®è¯æœç´¢
- ğŸ“– **è·å–é¡µé¢å†…å®¹** - æ”¯æŒé¡µé¢IDå’Œæ ‡é¢˜è·å–
- ğŸ§¹ **Wikiæ–‡æœ¬æ¸…ç†** - ç§»é™¤MediaWikiæ ‡è®°ï¼Œä¿ç•™æ ¸å¿ƒå†…å®¹
- ğŸ’¾ **æ™ºèƒ½ç¼“å­˜** - 30åˆ†é’Ÿç¼“å­˜ï¼Œæå‡å“åº”é€Ÿåº¦
- ğŸ› ï¸ **CLIè°ƒè¯•å·¥å…·** - å®Œæ•´çš„å‘½ä»¤è¡Œè°ƒè¯•ç•Œé¢
- ğŸš€ **MCPæœåŠ¡å™¨** - æ ‡å‡†MCPåè®®æ”¯æŒ

## å®‰è£…å’Œæ„å»º

```bash
# å®‰è£…ä¾èµ–
npm install

# ç¼–è¯‘TypeScript
npm run build

# æ¸…ç†ç¼–è¯‘æ–‡ä»¶
npm run clean
```

## CLI å·¥å…·ä½¿ç”¨

### åŸºæœ¬å‘½ä»¤

```bash
# æœç´¢èŒå¨˜ç™¾ç§‘
npm run test  # æœç´¢"èŠ™å®å¨œ"
node dist/cli.js search "å…³é”®è¯"

# è·å–é¡µé¢å†…å®¹
node dist/cli.js page "é¡µé¢IDæˆ–æ ‡é¢˜"
node dist/cli.js page "12345" --id  # æŒ‡å®šä¸ºID

# æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
node dist/cli.js cache-stats

# æ¸…ç†ç¼“å­˜
node dist/cli.js cache-clear
node dist/cli.js cache-clear --all  # æ¸…ç©ºæ‰€æœ‰ç¼“å­˜

# æµ‹è¯•APIè¿æ¥
node dist/cli.js test

# å¯åŠ¨MCPæœåŠ¡å™¨æ¨¡å¼
node dist/cli.js mcp
```

### é«˜çº§é€‰é¡¹

```bash
# æœç´¢é€‰é¡¹
node dist/cli.js search "åŸç¥" --limit 10 --json
node dist/cli.js search "å…³é”®è¯" --no-cache  # ä¸ä½¿ç”¨ç¼“å­˜

# é¡µé¢é€‰é¡¹
node dist/cli.js page "æ ‡é¢˜" --no-clean  # ä¸æ¸…ç†Wikiæ ‡è®°
node dist/cli.js page "æ ‡é¢˜" --json --no-cache
```

## MCP æœåŠ¡å™¨

### å¯åŠ¨æœåŠ¡å™¨

```bash
# ç›´æ¥å¯åŠ¨MCPæœåŠ¡å™¨
npm run mcp

# æˆ–é€šè¿‡CLIå¯åŠ¨
node dist/cli.js mcp
```

### å¯ç”¨å·¥å…·

- `search_moegirl` - æœç´¢èŒå¨˜ç™¾ç§‘æ¡ç›®
- `get_page` - è·å–é¡µé¢å†…å®¹
- `cache_stats` - æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
- `cache_clear` - æ¸…ç†ç¼“å­˜
- `server_status` - æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€

### èµ„æº

- `help://search` - æœç´¢å¸®åŠ©
- `help://cache` - ç¼“å­˜å¸®åŠ©
- `status://json` - æœåŠ¡å™¨çŠ¶æ€ï¼ˆJSONæ ¼å¼ï¼‰

## é¡¹ç›®ç»“æ„

```
src-ts/
â”œâ”€â”€ cli/                    # CLIå·¥å…·
â”‚   â”œâ”€â”€ commands.ts        # å‘½ä»¤å¤„ç†å™¨
â”‚   â””â”€â”€ index.ts           # æ¨¡å—å¯¼å‡º
â”œâ”€â”€ core/                   # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”œâ”€â”€ moegirl_client.ts  # èŒå¨˜ç™¾ç§‘å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ wikitext_cleaner.ts # Wikiæ–‡æœ¬æ¸…ç†
â”‚   â””â”€â”€ cache_manager.ts   # ç¼“å­˜ç®¡ç†
â”œâ”€â”€ mcp/                    # MCPæœåŠ¡å™¨
â”‚   â””â”€â”€ server.ts          # æœåŠ¡å™¨å®ç°
â”œâ”€â”€ types/                  # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ index.ts
â”œâ”€â”€ cli.ts                  # CLIä¸»å…¥å£
â”œâ”€â”€ mcp.ts                  # MCPä¸»å…¥å£
â””â”€â”€ index.ts                # æ¨¡å—å¯¼å‡º
```

## æŠ€æœ¯æ ˆ

- **Node.js** 18+
- **TypeScript** 5.9+
- **MCP SDK** - Model Context Protocol
- **Axios** - HTTPå®¢æˆ·ç«¯
- **Commander.js** - CLIæ¡†æ¶

## å¼€å‘

```bash
# å¼€å‘æ¨¡å¼ï¼ˆç›‘å¬æ–‡ä»¶å˜åŒ–ï¼‰
npm run dev

# è¿è¡Œæµ‹è¯•
npm test

# æ‰‹åŠ¨ç¼–è¯‘
npx tsc
```

## æ³¨æ„äº‹é¡¹

1. **ç½‘ç»œè¿æ¥** - éœ€è¦èƒ½å¤Ÿè®¿é—® `zh.moegirl.org.cn`
2. **ç¼“å­˜ç­–ç•¥** - æœç´¢å’Œé¡µé¢å†…å®¹é»˜è®¤ç¼“å­˜30åˆ†é’Ÿ
3. **Wikiæ¸…ç†** - åŸºäºAngel Eyeæ’ä»¶çš„æ¸…ç†é€»è¾‘ï¼Œä¿ç•™æ ¸å¿ƒå†…å®¹ç»“æ„
4. **é”™è¯¯å¤„ç†** - ç½‘ç»œé”™è¯¯ä¼šè¿”å›è¯¦ç»†é”™è¯¯ä¿¡æ¯

## æ•…éšœæ’é™¤

### ç½‘ç»œè¿æ¥é—®é¢˜

å¦‚æœé‡åˆ°è¿æ¥é”™è¯¯ï¼Œå¯ä»¥å°è¯•ï¼š

1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. ç¡®è®¤èƒ½å¤Ÿè®¿é—®èŒå¨˜ç™¾ç§‘
3. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
4. å°è¯•ä½¿ç”¨ä»£ç†

### ç¼–è¯‘é—®é¢˜

ç¡®ä¿ä½¿ç”¨Node.js 18+å’Œæ­£ç¡®çš„åŒ…ç®¡ç†å™¨ï¼š

```bash
# æ¸…ç†å¹¶é‡æ–°å®‰è£…
rm -rf node_modules dist
npm install
npm run build
```

## è®¸å¯è¯

MIT License